#ifndef WARP_BUILD_ENABLE_DEVINA219
#define WARP_BUILD_ENABLE_DEVINA219
#endif

typedef enum{
	INA219_ADDRESS=0x40,
	INA219_READ=0x01,
	INA219_REG_CONFIG=0x00,
	INA_CONFIG_RESET=0x8000,
	INA219_CONFIG_BVOLTAGERANGE_MASK=0x2000,
	INA219_CONFIG_GAIN_MASK=0x1800,
	INA219_CONFIG_BADCRES_MASK=0x0780,
	INA219_CONFIG_SADCRES_MASK=0x0078,
	INA219_CONFIG_MODE_MASK=0x0007,

	INA219_REG_SHUNTVOLTAGE=0x01,
	INA219_REG_BUSVOLTAGE=0x02,
	INA219_REG_POWER=0x03,
	INA219_REG_CURRENT=0x04,
	INA219_REG_CALIBRATION=0x05
}INA219Constants;

typedef enum{	
	INA219_CONFIG_BVOLTAGERANGE_16V=0x0000,
	INA219_CONFIG_BVOLTAGERANGE_32V=0x2000,

	INA219_CONFIG_GAIN_1_40MV=0x0000,
	INA219_CONFIG_GAIN_2_80MV=0x0800,
	INA219_CONFIG_GAIN_4_160MV=0x1000,
	INA219_CONFIG_GAIN_8_320MV=0x1800,

	INA219_CONFIG_BADCRES_9BIT=0x0000,
	INA219_CONFIG_BADCRES_10BIT=0x0080,
	INA219_CONFIG_BADCRES_11BIT=0x0100,
	INA219_CONFIG_BADCRES_12BIT=0x0180,

	INA219_CONFIG_SADCRES_9BIT_1S_84US=0x0000,
	INA219_CONFIG_SADCRES_10BIT_1S_148US=0x0008,
	INA219_CONFIG_SADCRES_11BIT_1S_276US=0x0010,
	INA219_CONFIG_SADCRES_12BIT_1S_532US=0x0018,
	INA219_CONFIG_SADCRES_12BIT_2S_1060US=0x0048,
	INA219_CONFIG_SADCRES_12BIT_4S_2130US=0x0050,
	INA219_CONFIG_SADCRES_12BIT_8S_4260US=0x0058,
	INA219_CONFIG_SADCRES_12BIT_16S_8510US=0x0060,
	INA219_CONFIG_SADCRES_12BIT_32S_17MS=0x0068,
	INA219_CONFIG_SADCRES_12BIT_64S_34MS=0x0070,
	INA219_CONFIG_SADCRES_12BIT_128S_69MS=0x0078

}devINACommands;

enum{
	INA219_CONFIG_MODE_SANDBVOLT_CONTINUOUS = 7
};

void
initINA219(const uint8_t i2cAddress, WarpI2CDeviceState volatile *  deviceStatePointer);

WarpStatus
writeSensorRegisterINA219(uint8_t deviceRegister, uint16_t payload);

WarpStatus
readSensorRegisterINA219(uint8_t deviceRegister, int numberOfBytes);

void setCalibration_32V_1A();

void setCalibration_32V_2A();

void setCalibration_16V_400mA();

int16_t getCurrent_raw();

float getCurrent_mA(void);
